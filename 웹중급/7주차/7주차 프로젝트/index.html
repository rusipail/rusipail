<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³´ë¬¼ì°¾ê¸°</title>
    <style>
        table {
            border-collapse: separate;
        }

        td:not(.gold-num,.bomb-num) {
            width: 60px;
            height: 60px;
            border: 1px solid black;
            text-align: center;
            line-height: 60px;
            background-color: black;
            cursor: pointer;
        }

        td.show {
            background-color: white;
        }

        tr:not(:nth-child(n + 3)) td {
            height: 16px;
            border: none;
            color: white;
            text-align: center;
            font-size: 14px;
            line-height: 1;
        }
        
        td:not(:nth-child(n + 3)) {
            width: 16px;
            border: none;
            color: white;
            text-align: center;
            font-size: 14px;
            line-height: 1;
        }

        tr:not(:nth-child(n + 3)) td:not(:nth-child(n + 3)) {
            background-color: transparent;
        }

        td.gold-num:not(.hide) {
            background-color: blue;
        }
        td.bomb-num:not(.hide) {
            background-color: red;
        }

        td{
            position:relative;
        }

        td.show::before{
            position:absolute;
            left:50%;
            top:50%;
            transform:translate(-50%, -50%);
            font-size:32px;
        }

        td.gold.show::before{
            content:"ğŸ’°";
        }

        td.bomb.show::before{
            content:"ğŸ’£";
        }
        
        td.expl.show::before{
            content:"ğŸ’¥";
        }

        #canvas:not(.die) > button{
            display: none;
        }
       .hide{
            background-color: white;
        }

    </style>
</head>

<body>
    <h1>ë³´ë¬¼ì°¾ê¸°</h1>
    <div>
        ê° ì¹¸ì€ 10% í™•ë¥ ë¡œ í­íƒ„, 20% í™•ë¥ ë¡œ ë³´ë¬¼ì´ ë“¤ì–´ìˆë‹¤.<br>
        íŒŒë€ìƒ‰ ì¹¸ì€ í•´ë‹¹ í–‰/ì—´ ì— ìˆëŠ” ë³´ë¬¼ì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ê³ <br>
        ë¹¨ê°„ìƒ‰ ì¹¸ì€ í•´ë‹¹ í–‰/ì—´ ì— ìˆëŠ” í­íƒ„ì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.<br><br>
    </div>
    <div id="canvas">
        <button>ë‹¤ì‹œ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</button><br>
        <table>
            <tbody></tbody>
        </table>
    </div>
    <script>
        const WIDTH = 6, HEIGHT = 6;
        const BOMB = 'bomb', GOLD = 'gold', NONE = 'none';
        const table = document.querySelector('tbody');
        const button = document.querySelector('#canvas > button');
        const canvas = document.querySelector('#canvas');

        /*
            td[i][j] -> i ë²ˆì§¸ ì¤„, j ë²ˆì§¸ ì¹¸
            td[0][j] -> ë³´ë¬¼ í‘œì‹œ ì¹¸
            td[1][j] -> í­íƒ„ í‘œì‹œ ì¹¸
            td[i][0] -> ë³´ë¬¼ í‘œì‹œ ì¹¸
            td[i][1] -> í­íƒ„ í‘œì‹œ ì¹¸

            map[i][j] -> td[i + 2][j + 2] ì¹¸ì— í‘œì‹œ
        */
        let map = [], tdList = []
        let count = 0;
        let goldC = 0;

        const initMap = () => {
            //let map = []
            for(let i = 0; i < HEIGHT; i++){
                map.push([]);
                for(let j = 0; j < WIDTH; j++){
                    let num = Math.random();
                    if(num <= 0.1){
                        a = BOMB;
                    }else if(num <= 0.3){
                        a = GOLD;
                        goldC += 1;
                    } else{
                        a = NONE;
                    }
                    // tdList[i + 2][j + 2].classList.add('a');
                    map[i].push(a)

                }
            }
            console.log(map)
            console.log(tdList)
            // 10% í™•ë¥ ë¡œ BOMB, 20% í™•ë¥ ë¡œ GOLD, 70%í™•ë¥ ë¡œ NONEì¸ 6 x 6 2ì°¨ì› ë°°ì—´ ìƒì„± í›„ mapì— í• ë‹¹
        };


        const makeTable = () => {
            table.innerHTML = '';
            
            for(let i = 0; i < HEIGHT + 2; i++){
                const tr = document.createElement('tr');
                tdList.push([])
                for(let j = 0; j < WIDTH + 2; j++){
                    const td = document.createElement('td');
                    td.dataset.x = `${j - 2}`;
                    td.dataset.y = `${i - 2}`;
                    tdList[i].push(td);
                    if(j === 0 || i === 0){
                        td.classList.add('gold-num');
                    } else if(j === 1 || i === 1){
                        td.classList.add('bomb-num');
                    }
                        
                    tr.appendChild(td);
                }
                table.appendChild(tr);
            }
            for(let i = 0; i < 6; i++){
                for(let j = 0; j < 6; j++){
                    /*if(td.classList.contains('NONE')){
                        map.splice([i][j], 1, NONE)
                    }*/
                    tdList[i + 2][j + 2].classList.add(`${map[i][j]}`);
                }
            }
            // ë°°ì—´ë³´ë‹¤ 2ì”© í° 8 x 8 í…Œì´ë¸”ì„ ë§Œë“ ë‹¤
            // ê° td íƒœê·¸ë“¤ì„ tdList ë°°ì—´ì— 2ì°¨ì› ë°°ì—´ë¡œ ë„£ëŠ”ë‹¤.
            // ê° td íƒœê·¸ì—ëŠ” ì²« ì¤„ ë˜ëŠ” ì²« ì¹¸ì—ëŠ” .gold-num ì„ í• ë‹¹
            // ë‘˜ì§¸ ì¤„ ë˜ëŠ” ë‘˜ì§¸ ì¹¸ì—ëŠ” .bomb-num ì„ í• ë‹¹í•œë‹¤.
        };

        const showCount = () => {
            let goldsX = 0;
            let bombsX = 0;
            let goldsY = 0;
            let bombsY = 0;
            for(let i = 0; i < 6; i++){
                for(let j = 0; j < 6; j++){
                    if(map[i][j] == GOLD){
                        goldsX = goldsX + 1;
                    } else if(map[i][j] == BOMB){
                        bombsX = bombsX + 1;
                    }
                    if(map[j][i] == GOLD){
                        goldsY = goldsY + 1;
                    } else if(map[j][i] == BOMB){
                        bombsY = bombsY + 1;
                    }
                }
                tdList[i + 2][0].innerHTML = goldsX;
                tdList[0][i + 2].innerHTML = goldsY;
                tdList[i + 2][1].innerHTML = bombsX;
                tdList[1][i + 2].innerHTML = bombsY;
                if(tdList[i + 2][0].innerHTML == 0){
                    tdList[i + 2][0].classList.add('hide');
                };
                if(tdList[0][i + 2].innerHTML == 0){
                    tdList[0][i + 2].classList.add('hide');
                };
                if(tdList[i + 2][1].innerHTML == 0){
                    tdList[i + 2][1].classList.add('hide');
                };
                if(tdList[1][i + 2].innerHTML == 0){
                    tdList[1][i + 2].classList.add('hide');
                };
                goldsX = 0;
                goldsY = 0;
                bombsX = 0;
                bombsY = 0;
            }
            
            // mapì„ í™•ì¸í•´ì„œ í•´ë‹¹ í–‰ê³¼ ì—´ì¸ .bomb-num, .gold-num ì— ì ì ˆí•œ ìˆ«ìë¥¼ ë„£ëŠ”ë‹¤.
            // .bomb-num ì—ëŠ” í•´ë‹¹ í–‰ ë˜ëŠ” ì—´ì— ìˆëŠ” í­íƒ„ì˜ ê°œìˆ˜ë¥¼
            // .gold-num ì—ëŠ” í•´ë‹¹ í–‰ ë˜ëŠ” ì—´ì— ìˆëŠ” ê³¨ë“œì˜ ê°œìˆ˜ë¥¼ ë„£ëŠ”ë‹¤.
            // ë§Œì•½ .bomb-num ë˜ëŠ” .gold-num ì˜ ê°’ì´ 0ì´ ëœë‹¤ë©´ hide í´ë˜ìˆ˜ë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.
        };

        const getCRT = (td) => {
            // ì„¸ë¡œìœ„ì¹˜, ê°€ë¡œìœ„ì¹˜, ì•ˆì˜ ê°’, tdíƒœê·¸ ë¥¼ ë°°ì—´ë¡œ ë¦¬í„´í•œë‹¤.  

            return [col, row, type, td];
        };

        const tdClickListener = e => {
            if(!canvas.classList.contains('die') && e.target.nodeName === 'TD'){
                const td = e.target;
                td.classList.add('show');
                if(td.classList.contains(BOMB)){
                    td.classList.add('expl');
                    canvas.classList.add('die')
                    console.log('bomb')
                    if(canvas.classList.contains('die')){
                        for(let i = 0; i < 8; i++){
                            for(let j = 0; j < 8; j++){
                                tdList[i][j].classList.add('show');
                            }
                        }
                    }
                } else if(td.classList.contains(GOLD)){
                    goldC = goldC - 1;
                    console.log(goldC)
                    td.classList.add('gold');
                    td.classList.add('NONE');
                    console.log('gold')
                    let j = td.dataset.x;
                    let i = td.dataset.y;
                    map[i].splice([j], 1, NONE);
                    showCount();
                    if(goldC === 0){
                        canvas.classList.add('die');
                    }
                    // recheck(e);
                        
                }

                
                // ëˆ„ë¥¸ í•´ë‹¹ tdëŠ” .show ë¥¼ ë„£ì–´ì¤€ë‹¤.
                // ë§Œì•½ bombì„ ëˆŒë €ë‹¤ë©´ .expl ë¥¼ ë„£ì–´ì¤€ë‹¤.
                // ê·¸ë¦¬ê³  canvas classì— .die ë¥¼ ë„£ì–´ì¤€ë‹¤.

                // ë§Œì•½ goldë¥¼ ëˆŒë €ë‹¤ë©´ .gold ë¥¼ ë„£ì–´ì¤€ë‹¤.
                // ê·¸ë¦¬ê³  í•´ë‹¹ map ë¶€ë¶„ì„ NONEìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤.
                // ë§Œì•½ ë‚¨ì•„ìˆëŠ” goldê°€ ì—†ë‹¤ë©´ canvas classì— .dieë¥¼ ë„£ì–´ì¤€ë‹¤.

                // ì´ë ‡ê²Œ classë¥¼ ì¶”ê°€í•˜ê³  ë‚˜ì„œ showCount í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.
            }
        }
        table.onclick =  tdClickListener;

        const init = () => {
            tdList = [];
            map = [];
            canvas.classList.remove('die');
            initMap();
            makeTable();
            showCount();
        };
        init();

        button.onclick = init;
        
        /*const recheck = e =>{
            for(let i = 0; i < 6; i++){
                for(let j = 0; j < 6; j++){
                    if(tdList[i][j].contains(NONE)){
                        map.splice([i][j], 1 , NONE)
                    } else {
                        console.log('false')
                    }
                }
            }
        }*/
    </script>
</body>

</html>